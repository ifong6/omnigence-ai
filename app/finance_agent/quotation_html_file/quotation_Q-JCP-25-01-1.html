<!DOCTYPE html><html lang="zh-Hant"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>QUOTATION — CHUNPAK ENGINEERING CONSULTANCY, LTD.</title><!-- Fonts --><link rel="preconnect" href="https://fonts.googleapis.com" /><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Noto+Sans+TC:wght@400;500;700;900&display=swap" rel="stylesheet" /><!-- Polyfills/Libraries --><script src="https://cdn.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.auto.min.js" defer></script><script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" defer></script><style>:root {--bg: #f7f7f8;--card: #ffffff;--ink: #0f172a;--muted: #64748b;--border: #e5e7eb;--brand: #111827;--accent: #0ea5e9;--row: #fafafa;--danger: #ef4444;}* { box-sizing: border-box; }html, body {margin: 0;padding: 0;background: var(--bg);color: var(--ink);font: 14px/1.6 "Inter","Noto Sans TC",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";}.container { max-width: 960px; margin: 40px auto; padding: 24px; }.card {background: var(--card);border-radius: 16px;box-shadow: 0 10px 25px rgba(0,0,0,0.06);overflow: hidden;border: 1px solid var(--border);}.header {padding: 28px 28px 8px;border-bottom: 1px solid var(--border);display: flex;align-items: flex-start;justify-content: space-between;gap: 16px;flex-wrap: wrap;}.brand { display: flex; flex-direction: column; gap: 6px; }.brand h1 { margin: 0; font-size: 22px; letter-spacing: 1.2px; font-family: "Noto Sans TC", Inter, sans-serif; }.brand .en { font-weight: 600; font-size: 12px; color: var(--muted); letter-spacing: 0.6px; }.meta { display: grid; gap: 6px; font-size: 13px; min-width: 280px; }.meta div { display: flex; justify-content: space-between; gap: 12px; }.pill {display: inline-block; border: 1px solid var(--border);padding: 4px 10px; border-radius: 999px; font-size: 12px; color: var(--muted);width: max-content;}.title { padding: 14px 28px 0; font-size: 24px; font-weight: 800; text-align: center; letter-spacing: 1px; }.subtitle { text-align: center; color: var(--muted); margin-top: 0; margin-bottom: 12px; font-size: 12px; }.section { padding: 20px 28px; }.grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }.kv { display: grid; gap: 4px; }.kv .label { color: var(--muted); font-size: 12px; }.badge {display: inline-flex; align-items: center; gap: 8px;background: #111827; color: #fff; border-radius: 999px;padding: 6px 12px; font-weight: 700; letter-spacing: 0.5px; font-size: 12px;}.badge .sub { opacity: 0.9; font-weight: 600; }/* Table sizing */.table-wrap { max-width: 840px; margin: 0 auto; }table {width: 100%;table-layout: fixed;border-collapse: separate;border-spacing: 0;border: 1px solid var(--border);border-radius: 12px;overflow: hidden;}thead th {background: var(--row);color: var(--muted);font-weight: 700;text-align: left;font-size: 12px;padding: 10px;border-bottom: 1px solid var(--border);}tbody td {padding: 10px;border-bottom: 1px solid var(--border);vertical-align: middle;}tbody tr:last-child td { border-bottom: none; }.num { text-align: center; white-space: nowrap; }.right { text-align: right; white-space: nowrap; }.muted { color: var(--muted); }.btns { display: flex; gap: 10px; flex-wrap: wrap; margin: 10px 0 16px; }.btn {appearance: none; border: 1px solid var(--border); background: #fff;border-radius: 10px; padding: 8px 12px; cursor: pointer; font-weight: 600;}.btn.primary { background: #0ea5e9; color: #fff; border-color: #0ea5e9; }.btn.danger { border-color: var(--danger); color: var(--danger); background: #fff; }.total { display: flex; justify-content: flex-end; padding: 16px 0 0; }.total-card { min-width: 340px; border: 1px solid var(--border); border-radius: 12px; overflow: hidden; }.total-row { display: flex; justify-content: space-between; padding: 12px 16px; font-weight: 600; border-bottom: 1px solid var(--border); }.total-row:last-child { border-bottom: none; background: #fafafa; font-size: 18px; }.footer { padding: 22px 28px 28px; color: var(--muted); font-size: 12px; }/* Inputs */input[type="number"]::-webkit-outer-spin-button,input[type="number"]::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }input[type="number"] { -moz-appearance: textfield; }.cell-input { width: 100%; border: none; background: transparent; }.cell-input.num { text-align: center; }.cell-input.price { text-align: right; }.cell-desc { overflow-wrap: anywhere; word-break: break-word; }.remove-btn { padding: 4px 8px; }[contenteditable="true"] { outline: 2px dashed transparent; border-radius: 6px; }[contenteditable="true"]:focus { outline-color: #dbeafe; background: #f8fafc; }@media (max-width: 860px) {.grid-2 { grid-template-columns: 1fr; }.right, .num { text-align: left; }.table-wrap { max-width: 100%; }}@media print {html, body { background: #fff; }.container { margin: 0; padding: 0; max-width: none; }.card { border: none; box-shadow: none; border-radius: 0; }.btns { display: none !important; }}</style></head><body><div class="container"><div class="card"><div class="header"><div class="brand"><h1>浚珀工程顧問有限公司</h1><div class="en">CHUNPAK ENGINEERING CONSULTANCY, LTD.</div><span class="pill">澳門 • Engineering Consultancy</span></div><div class="meta"><div><span>[編號]</span><strong id="No" contenteditable="true">Q-JCP-25-01-1</strong></div><div><span>日期</span><strong id="Date" contenteditable="true">2025-10-02</strong></div></div></div><div class="title">報價單 QUOTATION SHEET</div><div class="subtitle">— Official quotation —</div><div class="section grid-2"><div class="kv"><div class="label">客戶</div><div><strong id="customerName" contenteditable="true">長聯建築工程有限公司</strong></div></div><div class="kv"><div class="label">地址</div><div><span class="muted" id="customerAddr" contenteditable="true">Unknown</span></div></div></div><div class="section"><div class="badge">項目名稱<span class="sub" id="projectName" contenteditable="true">A3連接橋D匝道箱樑木模板支撐架計算</span></div></div><!-- Table --><div class="table-wrap"><table id="itemsTable"><colgroup><col style="width:50px">   <!-- 序號 --><col>                      <!-- 內容 (flex) --><col style="width:68px">   <!-- 數量 --><col style="width:68px">   <!-- 單位 --><col style="width:120px">  <!-- 單價 --><col style="width:120px">  <!-- 小計 --><col style="width:48px">   <!-- 操作 --></colgroup><thead><tr><th class="num">序號</th><th>內容</th><th class="num">數量</th><th class="num">單位</th><th class="right">單價（澳門元）</th><th class="right">小計（澳門元）</th><th></th></tr></thead><tbody id="tbody"><tr><td class="num">1</td><td>A3連接橋D匝道箱樑木模板支撐架計算</td><td class="num">1</td><td class="num">Lot</td><td class="right">MOP $7,000.00</td><td class="right">MOP $7,000.00</td></tr></tbody></table></div><div class="section"><div class="btns"><button class="btn primary" id="btnAdd" type="button">＋ 添加項目</button><button class="btn" id="btnClear" type="button">清空所有</button><button class="btn" id="btnExport" type="button">導出PDF</button></div></div><div class="section"><div class="total"><div class="total-card"><div class="total-row"><span>合計</span><span id="grandtotal"><strong>MOP $7,000.00</strong></span></div></div></div></div><div class="footer"><p contenteditable="true">備註：<br />1.本報價不包括任何文件運輸及提交工作;<br />2.本報價不包括文件打印服務;<br />3.本報價在發出日起60天有效;<br />4.如對本報價有何問題請與我司聯繫。</p></div></div></div><script>const fmt = (n) =>"MOP $" + (Number(n) || 0).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });function getTbody() { return document.getElementById("tbody"); }function clampNonNegativeNumber(input) {const v = parseFloat(input.value);if (isNaN(v) || v < 0) input.value = "0";}function addRow(data = { desc: "", qty: 1, unit: "Lot", price: 0 }) {const tbody = getTbody();const i = tbody.querySelectorAll("tr").length + 1;const tr = document.createElement("tr");tr.innerHTML = `<td class="num"><input class="cell-input num" type="number" min="1" value="${i}"></td><td><input class="cell-input cell-desc" type="text" value="${data.desc || ""}" placeholder="內容 / Description"></td><td class="num"><input class="cell-input num" type="number" min="0" step="1" value="${data.qty ?? 1}"></td><td class="num"><select class="cell-input">${["Lot","件","套","m","m²","hr"].map(u => `<option ${u === (data.unit || "Lot") ? "selected" : ""}>${u}</option>`).join("")}</select></td><td class="right"><input class="cell-input price" type="number" min="0" step="0.01" value="${data.price ?? 0}"></td><td class="right"><span class="line-subtotal">MOP $0.00</span></td><td class="num"><button class="btn danger remove-btn" data-remove type="button">✕</button></td>`;tbody.appendChild(tr);recalc();}function removeRow(btn) {const tbody = getTbody();const tr = btn.closest("tr");if (tr) tr.remove();Array.from(tbody.querySelectorAll("tr")).forEach((row, idx) => {const serialInput = row.cells[0].querySelector("input");if (serialInput) serialInput.value = idx + 1;});recalc();}function clearRows() {getTbody().innerHTML = "";recalc();}function recalc() {const tbody = getTbody();let subtotal = 0;Array.from(tbody.querySelectorAll("tr")).forEach((row) => {const qty   = parseFloat(row.cells[2].querySelector("input")?.value || 0);const price = parseFloat(row.cells[4].querySelector("input")?.value || 0);const line  = (isFinite(qty) ? qty : 0) * (isFinite(price) ? price : 0);subtotal += line;const cell = row.cells[5].querySelector(".line-subtotal");if (cell) cell.textContent = fmt(line);});document.getElementById("grandtotal").innerHTML = "<strong>" + fmt(subtotal) + "</strong>";}async function exportPDF() {const element = document.querySelector(".card");const fn = (document.getElementById("No")?.textContent || "quotation") + ".pdf";const btns = document.querySelector(".btns");if (btns) btns.style.display = "none";try {if (window.html2pdf) {await html2pdf().set({margin: 10,filename: fn,image: { type: "jpeg", quality: 0.98 },html2canvas: { scale: 2, useCORS: true, letterRendering: true },jsPDF: { unit: "mm", format: "a4", orientation: "portrait" },}).from(element).save();} else {window.print();}} finally {if (btns) btns.style.display = "flex";}}document.addEventListener("DOMContentLoaded", () => {const tbody = getTbody();document.getElementById("btnAdd").addEventListener("click", () => addRow());document.getElementById("btnClear").addEventListener("click", clearRows);document.getElementById("btnExport").addEventListener("click", exportPDF);tbody.addEventListener("click", (e) => {const btn = e.target.closest("[data-remove]");if (btn) removeRow(btn);});tbody.addEventListener("input", (e) => {if (e.target.matches('input[type="number"]')) clampNonNegativeNumber(e.target);recalc();});tbody.addEventListener("change", (e) => {if (e.target.matches("select")) recalc();});});</script></body></html>